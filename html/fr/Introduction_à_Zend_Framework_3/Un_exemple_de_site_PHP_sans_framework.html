<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book on Zend Framework for beginners">
<meta name="keywords" content="zend framework,book,beginner,free">
<meta name="author" content="2018 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Un exemple de site PHP sans framework &ndash; Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book on Zend Framework for beginners            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Home</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/zf3-api-reference/html/">Class Reference</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Introduction_à_Zend_Framework_3/Qu_est_ce_que_Zend_Framework_3_.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Introduction_à_Zend_Framework_3/License.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Introduction_à_Zend_Framework_3.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Introduction à Zend Framework 3</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">
<div class="incomplete-translation">
    Translation into this language is not yet finished. You can help this project 
    by translating the chapters and contributing your changes.
</div>

<h2 id="Un_exemple_de_site_PHP_sans_framework">1.2. Un exemple de site PHP sans framework</h2>
<p>Pour vous montrer comme il est difficile de construire un site <em>sans</em> framework PHP, 
nous allons écrire un site très simple composé de trois pages HTML: <em>Accueil</em>, <em>Connexion</em> et <em>Déconnexion</em>.</p>
<blockquote class="notquote information" data-type="information"><p> Petite précision, écrire un site avec un framework PHP peut également être difficile, mais avec un framework vous le ferez de manière cohérente et sécurisée.</p>
</blockquote><h3 id="Page_d_accueil">1.2.1. Page d'accueil</h3>
<blockquote class="notquote information" data-type="information"><p> Lorsque vous écrivez un site en PHP, vous mettez votre code dans un fichier avec l'extension <em>.php</em>. Un tel fichier s'appelle
un <em>script</em> PHP.</p>
</blockquote><p>Pour commencer, implémentons la page <em>Home</em> du site. Pour ce faire, créez un fichier <em>index.php</em> à la racine de votre répertoire Apache et placez le code suivant:</p>
<blockquote class="notquote tip" data-type="tip"><p> Pour comprendre le code ci-dessous, vous devez avoir un peu d'expérience avec PHP. Si ce n'est pas le cas, il serait bon de vous référez à un tutoriel PHP comme ceux du <a target="_blank" href="http://www.w3schools.com/php/">w3schools.com</a>.</p>
</blockquote><pre class=""><code class="language-php">&lt;?php 
// index.php
session_start();

// Si l'utilisateur est connecté, on récupère son identité via la session.
$identity = null;
if (isset($_SESSION['identity'])) {
    $identity = $_SESSION['identity'];
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Page d'accueil&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Page d'accueil&lt;/h1&gt;
        &lt;?php if ($identity==null): ?&gt;
        &lt;a href="login.php"&gt;Connexion&lt;/a&gt;
        &lt;?php else: ?&gt;
        &lt;strong&gt;Bienvenue, &lt;?= $identity ?&gt;&lt;/strong&gt; &lt;a href="logout.php"&gt;Déconnexion&lt;/a&gt;
        &lt;?php endif; ?&gt;
        
        &lt;p&gt;
            Ceci est un simple site web pour démontrer les avantages d'un framework PHP et les inconvénients du PHP "pur".
        &lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Si vous tapez "http://localhost/index.php" dans votre navigateur (comme Google Chrome ou Firefox), vous devriez voir une page comme ci-dessous :</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/intro/simple_home_page.png">
<img src="../../en/images/intro/simple_home_page.png" alt="Une page d'accueil simple" /></a>
<span class="image-caption">Une page d'accueil simple</span>
</span>
</p>
<h3 id="Page_Connexion">1.2.2. Page Connexion</h3>
<p>Maintenant, implémentons la page <em>Connexion</em>. Ce genre de page devrait présenter un formulaire avec les champs <em>E-mail</em> et <em>Mot de passe</em>. Une fois que l'utilisateur valide le formulaire, il passe l'authentification et son identité est enregistrée dans la session PHP. Le script ressemblerait alors à ceci :</p>
<pre class=""><code class="language-php">&lt;?php 
// login.php
session_start();

// Si l'utilisateur est connecté, on le redirige vers index.php
if (isset($_SESSION['identity'])) {
    header('Location: index.php');
    exit;
}

// On vérifie que le formulaire est soumis.
$submitted = false;
if ($_SERVER['REQUEST_METHOD']=='POST') {
    
    $submitted = true;
    
    // On récupère les données du formulaire
    $email = $_POST['email'];
    $password = $_POST['password'];
    
    // On authentifie l'utilisateur
    $authenticated = false;
    if ($email=='admin@example.com' &amp;&amp; $password=='Secur1ty') {
        $authenticated = true;
        
        // On enregistre son identité en session.
        $_SESSION['identity'] = $email;
        
        // On redirige l'utilisateur vers la page index.php.
        header('Location: index.php');
        exit;
    }
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Page de connexion&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Connexion&lt;/h1&gt;
        &lt;?php if ($submitted &amp;&amp; !$authenticated): ?&gt;
            &lt;div class="alert"&gt;
                Les informations d'identification sont invalides.
            &lt;/div&gt;
        &lt;?php endif; ?&gt;
        &lt;form name="login-form" action="/login.php" method="POST"&gt;
            &lt;label for="email"&gt;E-mail&lt;/label&gt;
            &lt;input type="text" name="email"&gt;
            &lt;br&gt;
            &lt;label for="password"&gt;Mot de passe&lt;/label&gt;
            &lt;input type="password" name="password"&gt;
            &lt;br&gt;
            &lt;input type="submit" name="submit" value="Connexion"&gt;
        &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Si vous ouvrez la page "http://localhost/login.php" dans votre navigateur, vous devriez voir quelque chose comme ca :</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/intro/simple_login_page.png">
<img src="../../en/images/intro/simple_login_page.png" alt="A page de connexion simple" /></a>
<span class="image-caption">A page de connexion simple</span>
</span>
</p>
<blockquote class="notquote tip" data-type="tip"><p> Pour vous connecter, utilisez <code>admin@example.com</code> and <code>Secur1ty</code> comme e-mail et mot de passe. </p>
</blockquote><h3 id="Page_Déconnexion">1.2.3. Page Déconnexion</h3>
<p>Et pour finir, implémentons la page <em>Déconnexion</em> qui va effacer l'identité de l'utilisateur enregistré en session:</p>
<pre class=""><code class="language-php">&lt;?php 
// logout.php
session_start();

unset($_SESSION['identity']);
header('Location: index.php');
exit;
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> Le code complet de ce site simple peut être trouvé dans l'exemple 
 <a target="_blank" href="https://github.com/olegkrivtsov/using-zf3-book-samples/tree/master/purephp">PHP pur</a> fourni avec ce livre.</p>
</blockquote><h3 id="Relecture_du_code">1.2.4. Relecture du code</h3>
<p>Les scripts ci-dessus ne sont pas seulement un exemple typique d'un site PHP "pur". 
Ils sont aussi un exemple de <em>comment ne pas écrire</em> vos sites (même les plus simples). Quels sont les problèmes ?</p>
<ol>
<li><p>Les scripts <em>index.php</em> et <em>login.php</em> aurait tendance à être fusionner en un seul fichier.
Vous n'avez aucune séparation des objectifs, ce qui rend votre code trop complexe.
Intuitivement, vous comprenez qu'il serait être plus pratique de diviser le code qui gère l'authentification de celui qui concerne la présentation (rendu HTML).</p>
</li>
<li><p>Les URL de vos pages ne sont pas terribles (par exemple, "http://localhost/index.php"). Il vaudrait mieux cacher cette extension ".php". 
Et que se passe-t-il lorsqu'un utilisateur Web tente de visiter une page qui n'existe pas?
Il vaudrait mieux rediriger l'utilisateur vers une page d'erreur dans ce cas.</p>
</li>
<li><p>Et si ce site devait s'agrandir ? Comment organiseriez-vous votre code? Un script PHP par page ?
Et si vous voulez réutiliser certains de vos scripts PHP sur d'autres sites web sans modifications? Intuitivement 
vous pourriez comprendre qu'il serait utile d'organiser le code dans une sorte de <em>module</em> réutilisable.</p>
</li>
<li><p>Les scripts <em>index.php</em> et <em>login.php</em> contiennent des balises HTML en commun. Pourquoi les copier dans tous les scripts PHP, alors 
que nous souhaitons réutiliser cette disposition sur toutes (ou presque toutes) les pages.</p>
</li>
<li><p>Le script <em>login.php</em> a des problèmes de sécurité, car nous n'avons implémenté aucune validation des variables POST.
La session PHP est également soumise au piratage. Et le script PHP <em>login.php</em> sera situé dans le répertoire racine du serveur Apache, 
ce qui n'est pas très sécurisé (il serait préférable de le placer dans un endroit inaccessible aux internautes). 
Le fichier <em>index.php</em> est également non sécurisé, car nous n'avons pas filtré la sortie PHP (sujette aux attaques XSS).   </p>
</li>
<li><p>Ces scripts n'utilisent aucune classe PHP. Encapsuler la fonctionnalité dans les classes en théorie rendrait le code bien structuré et facile à maintenir.   </p>
</li>
<li><p>Dans ces scripts, vous devez écrire votre propre implémentation de l'authentification de l'utilisateur (et ainsi de suite). Pourquoi réinventer la roue et ne pas utiliser une librairie bien conçue pour cela ?   </p>
</li>
</ol>
<p>Les problèmes ci-dessus sont facilement résolus lorsque vous écrivez un site Web avec un framework (comme Zend Framework 3):</p>
<ol>
<li><p>Avec ZF3, vous utilisez le modèle de conception <em>Model-Vue-Controller</em>, divisant votre code PHP en Modèles (le code responsable de l'authentification irait ici), 
 Vues (le code responsable du rendu HTML irait ici) et Controleurs (le code responsable de la récupération des variables POST irait ici).</p>
</li>
<li><p>Le routage <em>ZF3</em> permet de faire un affichage plus professionnel des URL en masquant les extensions .php. La facon dont les URL doivent être composées sont définies par des règles strictes. 
Si un utilisateur essaie d'accéder à une page inexistante, il est automatiquement redirigé vers une page d'erreur standard.</p>
</li>
<li><p>En ZF3, vous pouvez utiliser le concept de <em>module</em>. Cela permet de séparer facilement vos modèles, vues et contrôleurs en unité autonome (module) et de réutiliser facilement cette unité dans un autre projet.</p>
</li>
<li><p>Dans ZF3, vous pouvez définir une vue (<em>layout</em>) commune et la réutiliser sur toutes (ou la plupart) des pages.</p>
</li>
<li><p>ZF3 vous offre diverses fonctions de sécurité, telles que des filtres et validateurs de formulaires, des échappements de code, des validateurs de session, des algorithmes de cryptographie, etc. 
Dans un site web ZF3, seul l'<em>index.php</em> est accessible aux internautes, tous les autres scripts PHP sont situés en dehors du répertoire racine du serveur Apache.</p>
</li>
<li><p>Dans un site ZF3, vous mettez votre code dans des classes, ce qui le rend bien organisé.</p>
</li>
<li><p>ZF3 vous fournit de nombreux composants que vous pouvez utiliser dans votre site Web: un composant pour l'authentification, un composant pour travailler avec des formulaires, etc. </p>
</li>
</ol>
<blockquote class="notquote tip" data-type="tip"><p> Vous avez maintenant une idée des avantages de Zend Framework 3 et de ce qu'il peut faire pour vous. Dans les sections suivantes, nous décrirons ZF3 plus en détail.</p>
</blockquote>        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Introduction_à_Zend_Framework_3.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Introduction à Zend Framework 3</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Introduction_à_Zend_Framework_3/Qu_est_ce_que_Zend_Framework_3_.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Introduction_à_Zend_Framework_3/License.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright &copy; 2018 by Oleg Krivtsov            </div>
            <div class="footer-menu">
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/terms-and-conditions.html">Terms &amp; Conditions</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/copyright-policy.html">Copyright Policy</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/privacy-policy.html">Privacy Policy</a>
                </div>
                            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>
<script src="../../assets/js/popup.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

