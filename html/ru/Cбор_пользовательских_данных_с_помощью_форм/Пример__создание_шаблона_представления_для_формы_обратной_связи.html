<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free, read-frendly and open-source book on ZF3">
<meta name="keywords" content="zend framework,book,beginner,free">
<meta name="author" content="2018 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Пример: создание шаблона представления для формы обратной связи &ndash; Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free, read-frendly and open-source book on ZF3            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Home</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/zf3-api-reference/html/">Class Reference</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Cбор_пользовательских_данных_с_помощью_форм/Стандартные_помощники_видов_форм.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Cбор_пользовательских_данных_с_помощью_форм/Выводы.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Cбор_пользовательских_данных_с_помощью_форм.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Cбор пользовательских данных с помощью форм</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">

<h2 id="Пример__создание_шаблона_представления_для_формы_обратной_связи">7.14. Пример: создание шаблона представления для формы обратной связи</h2>
<p>Теперь мы можем определить представление для нашей формы обратной связи.
Если помните, ранее мы добавили шаблон представления <em>contact-us.phtml</em> в
каталог <em>application/index/</em> под каталогом модуля <em>view/</em>. Замените код
в этом файле на следующий:</p>
<pre class="line-numbers"><code class="language-php">&lt;?php
$form = $this-&gt;form;
$form-&gt;prepare();
?&gt;

&lt;?= $this-&gt;form()-&gt;openTag($form); ?&gt;
	
&lt;?= $this-&gt;formLabel($form-&gt;get('email')); ?&gt;
&lt;?= $this-&gt;formElement($form-&gt;get('email')); ?&gt;
&lt;?= $this-&gt;formElementErrors($form-&gt;get('email')); ?&gt;                  
	
&lt;?= $this-&gt;formLabel($form-&gt;get('subject')); ?&gt;
&lt;?= $this-&gt;formElement($form-&gt;get('subject')); ?&gt;
&lt;?= $this-&gt;formElementErrors($form-&gt;get('subject')); ?&gt;
   
&lt;?= $this-&gt;formLabel($form-&gt;get('body')); ?&gt;
&lt;?= $this-&gt;formElement($form-&gt;get('body')); ?&gt;
&lt;?= $this-&gt;formElementErrors($form-&gt;get('body')); ?&gt;                  
	
&lt;?= $this-&gt;formElement($form-&gt;get('submit')); ?&gt;
	
&lt;?= $this-&gt;form()-&gt;closeTag(); ?&gt;
</code></pre>
<p>Как видите из фрагмента выше, для визуализации формы мы делаем следующее:</p>
<ul>
<li><p>В строке 2 мы обращаемся к переменной $form, переданной от действия контроллера. </p>
</li>
<li><p>В строке 3 мы вызываем метод <code>prepare()</code> для подготовки формы к 
визуализации. Обратите внимание, что вызов этого метода крайне важен. Если вы забудете
это сделать, могут возникнуть нежелательные проблемы с визуализацией.</p>
</li>
<li><p>В строке 6 мы вызываем метод <code>openTag()</code> помощника вида <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/Form.html" class="api-link">Form</a></code>. Его задача - визуализировать
открывающий тег <code>&lt;form&gt;</code> и его атрибуты. Этот метод принимает один аргумент -- экземпляр
модели формы. Закрывающий тег <code>&lt;/form&gt;</code> визуализируется в строке 22 с помощью метода
<code>closeTag()</code>.</p>
</li>
<li><p>В строках 8-10 мы визуализируем метку моля электронной почты, само поле текста и возможные
ошибки валидации с помощью помощников видов <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormLabel.html" class="api-link">FormLabel</a></code>, <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormElement.html" class="api-link">FormElement</a></code> и <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormElementErrors.html" class="api-link">FormElementErrors</a></code>.
Эти помощники принимают в качестве единственного аргумента экземпляр элемента модели формы,
который мы получаем методом <code>get()</code>, предоставляемым базовым классом <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/Form.html" class="api-link">Form</a></code>.</p>
</li>
<li><p>В строках 12-24 мы аналогичным образом визуализируем поле темы письма, его метку и ошибки валидации.</p>
</li>
<li><p>Наконец, в строке 16-18 мы визуализируем метку, поле и ошибки валидации для поля области основного текста.</p>
</li>
<li><p>В строке 20 мы визуализируем кнопку отправки формы.</p>
</li>
</ul>
<p>После исполнения этого кода визуализатором шаблона представления , мы получим следующий HTML-код: </p>
<pre class=""><code class="language-html">&lt;form action="/contact" method="post" name="contact-form"&gt;
  &lt;label for="email"&gt;Your E-mail&lt;/label&gt;
  &lt;input type="text" name="email" id="email" value=""&gt;
        
  &lt;label for="subject"&gt;Subject&lt;/label&gt;
  &lt;input name="subject" type="text" id="subject" value=""&gt;

  &lt;label for="body"&gt;Message Body&lt;/label&gt;
  &lt;textarea name="body" id="body"&gt;&lt;/textarea&gt;
       
  &lt;input name="submit" type="submit" value="Submit"&gt;
&lt;/form&gt;
</code></pre>
<blockquote class="notquote information" data-type="information"><p> Во фрагменте выше мы в основном использовали помощники видов <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormElement.html" class="api-link">FormElement</a></code>, <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormElementErrors.html" class="api-link">FormElementErrors</a></code>
 и <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormLabel.html" class="api-link">FormLabel</a></code>. Вы можете использовать общие помощники <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormRow.html" class="api-link">FormRow</a></code> или <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/Form.html" class="api-link">Form</a></code>, если
 хотите писать меньше кода, но это может привести к снижению возможностей управления оформлением формы.</p>
</blockquote><p>Если определенные поля имеют ошибки валидации, эти ошибки будут выведены
под полем в виде неупорядоченного HTML-списка <code>&lt;ul&gt;</code>.
Например, если вы введете "123@hostname" в поле формы электронной почты,
вы получите следующие ошибки валидации:</p>
<pre class=""><code class="language-html">&lt;label for="email"&gt;Your E-mail&lt;/label&gt;
&lt;input type="text" name="email" value="123@hostname"&gt;
&lt;ul&gt;
  &lt;li&gt;&amp;#039;hostname&amp;#039; is not a valid hostname for the email address&lt;/li&gt;
  &lt;li&gt;The input does not match the expected structure for a DNS hostname&lt;/li&gt;
  &lt;li&gt;The input appears to be a local network name but local network names 
      are not allowed&lt;/li&gt;
&lt;/ul&gt; 
</code></pre>
<h3 id="Применение_CSS_стилей_Bootstrap_к_форме">7.14.1. Применение CSS-стилей Bootstrap к форме</h3>
<p>Созданной выше HTML-разметке не хватает стилизации CSS. Мы хотим добиться
привлекательного, профессионально выглядящего внешнего вида формы с помощью
CSS-классов Twitter Bootstrap. Для добавления стилизации Bootstrap к форме,
нужно изменить код в файле <em>.phtml</em>, чтобы он выглядел как показано ниже:</p>
<pre class="line-numbers"><code class="language-php">&lt;?php
$form = $this-&gt;form;
$form-&gt;prepare();

$form-&gt;get('email')-&gt;setAttributes([
  'class'=&gt;'form-control', 
  'placeholder'=&gt;'name@example.com'
  ]);
  
$form-&gt;get('subject')-&gt;setAttributes([
  'class'=&gt;'form-control', 
  'placeholder'=&gt;'Type subject here'
  ]);
  
$form-&gt;get('body')-&gt;setAttributes([
  'class'=&gt;'form-control', 
  'rows'=&gt;6, 
  'placeholder'=&gt;'Type message text here'
  ]);
  
$form-&gt;get('submit')-&gt;setAttributes(['class'=&gt;'btn btn-primary']);
?&gt;

&lt;h1&gt;Contact Us&lt;/h1&gt;

&lt;p&gt;
  Пожалуйста, заполните следующую форму для связи с нами. 
  Мы высоко ценим ваши отзывы.
&lt;/p&gt;

&lt;div class="row"&gt;
  &lt;div class="col-md-6"&gt;
    &lt;?= $this-&gt;form()-&gt;openTag($form); ?&gt;
        
    &lt;div class="form-group"&gt;
      &lt;?= $this-&gt;formLabel($form-&gt;get('email')); ?&gt;
      &lt;?= $this-&gt;formElement($form-&gt;get('email')); ?&gt;
      &lt;?= $this-&gt;formElementErrors($form-&gt;get('email')); ?&gt;
    &lt;/div&gt;
        
    &lt;div class="form-group"&gt;
      &lt;?= $this-&gt;formLabel($form-&gt;get('subject')); ?&gt;
      &lt;?= $this-&gt;formElement($form-&gt;get('subject')); ?&gt;
      &lt;?= $this-&gt;formElementErrors($form-&gt;get('subject')); ?&gt;
    &lt;/div&gt;
        
    &lt;div class="form-group"&gt;
      &lt;?= $this-&gt;formLabel($form-&gt;get('body')); ?&gt;
      &lt;?= $this-&gt;formElement($form-&gt;get('body')); ?&gt;
      &lt;?= $this-&gt;formElementErrors($form-&gt;get('body')); ?&gt;
    &lt;/div&gt;
        
    &lt;?= $this-&gt;formElement($form-&gt;get('submit')); ?&gt;
        
    &lt;?= $this-&gt;form()-&gt;closeTag(); ?&gt;
  &lt;/div&gt;    
&lt;/div&gt;
</code></pre>
<p>В этом фрагменте мы добавили CSS-класс <code>.form-control</code> к каждому полю ввода в форме.
Мы сделали это методом <code>setAttribute()</code> (см. строки 5, 10 и 15).
С помощью данного метода мы также добавили атрибут "placeholder" для определения
привлекательного текста плейсхолдера, когда поле пусто. Для поля "body" мы добавили
атрибут "rows", определяющий высоту поля (6 строк).</p>
<p>Для кнопки формы <em>Submit</em> мы используем CSS-классы <code>.btn</code> и <code>.btn-primary</code> 
(см. строку 21).</p>
<p>Мы помещаем пары «метка-ввод» в элементы <code>&lt;div&gt;</code> с помощью CSS-класса <code>.form-group</code> 
(строки 35, 41, 47).</p>
<p>Мы также помещаем форму в ячейку сетки шириной в 6 столбцов, что делает форму шириной 
в половину экрана.</p>
<blockquote class="notquote tip" data-type="tip"><p> Иногда невозможно использовать стили Twitter Bootstrap со стандартными помощниками вида ZF3 для рендеринга форм.
 Например, стандартные помощники вида <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormCheckbox.html" class="api-link">FormCheckbox</a></code> и <code><a target="_blank" href="https://olegkrivtsov.github.io/zf3-api-reference/html/classes/Zend/Form/View/Helper/FormRadio.html" class="api-link">FormRadio</a></code> не могут быть использованы со стилями
 Bootstrap. К счастью, существует сторонний модуль <a target="_blank" href="https://github.com/neilime/zf2-twb-bundle">neilime/zf2-twb-bundle</a>
 , который вы можете установить с помощью Composer (не смущайтесь имени модуля - он вполне поддерживает ZF3). Данный модуль предоставляет удобные помощники вида для рендеринга форм ZF3
 и применения к ним стилей Bootstrap. Он работает прозрачно, так что когда вы установили модуль, стандартные помощники вида ZF3 для рендеринга форм
 заменяются на помощники, предоставляемые модулем, то есть вам не придется менять код своих шаблонов представлений.</p>
</blockquote><h3 id="Стилизация_списка_ошибок_валидации">7.14.2. Стилизация списка ошибок валидации</h3>
<p>По умолчанию, сообщения об ошибках на вашей форме выглядят как типичный неупорядоченный
список (<code>&lt;ul&gt;</code>). Чтобы придать им приятный внешний вид, мы добавим пару CSS-правил в файл
<em>style.css</em> в каталоге <em>APP_DIR/public</em>:</p>
<pre class=""><code class="language-css">form ul {
  list-style-type: none;
  padding: 0px;
  margin: 0px 5px;
}

form ul li {    
  color: red;        
}
</code></pre>
<p>С помощью этих CSS-правил из списка убираются маркеры, а сообщения об ошибках валидации
показываются красным.</p>
<h3 id="Добавление_страниц__Thank_You__и__Error_Sending_Email_">7.14.3. Добавление страниц "Thank You" и "Error Sending Email"</h3>
<p>И наконец, последнее, что мы сделаем - подготовим шаблоны представления для
страниц благодарности и ошибки отправки письма ("Thank You" и "Error Sending Email").</p>
<p>Добавим шаблон представления <em>thank-you.phtml</em> в каталог <em>application/index/</em> под
каталогом модуля <em>view/</em> и поместим следующую HTML-разметку в файл шаблона представления:</p>
<pre class=""><code class="language-html">&lt;h1&gt;Спасибо!&lt;/h1&gt;

&lt;p&gt;
  &lt;div class="alert alert-success"&gt;
    Мы ответим на указанный вами адрес электронной почты.
  &lt;/div&gt;
&lt;/p&gt;
</code></pre>
<p>Затем добавим файл шаблона представления <em>send-error.phtml</em>. 
HTML-разметка для страницы ошибки отправки письма представлены ниже:</p>
<pre class=""><code class="language-html">&lt;h1&gt;Ошибка отправки письма!&lt;/h1&gt;

&lt;p&gt;
  &lt;div class="alert alert-warning"&gt;
    Возникла непредвиденная ошибка при попытке отправки
    вашего сообщения. Пожалуйста, повторите попытку позже.
  &lt;/div&gt;
&lt;/p&gt;
</code></pre>
<h3 id="Результат">7.14.4. Результат</h3>
<p>Поздравляем! Теперь при открытии в браузере URL "http://localhost/contactus",
вы должны увидеть страницу как на рисунке 7.20.</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/forms/contact_form.png">
<img src="../../en/images/forms/contact_form.png" alt="Рисунок 7.20. Форма обратной связи" /></a>
<span class="image-caption">Рисунок 7.20. Форма обратной связи</span>
</span>
</p>
<p>Если вы введете недействительные данные в форму и нажмете на кнопку отправки,
вы должны будете увидеть ошибки валидации (рисунок 7.21).</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/forms/validation_errors_page.png">
<img src="../../en/images/forms/validation_errors_page.png" alt="Рисунок 7.21. Ошибки валидации формы" /></a>
<span class="image-caption">Рисунок 7.21. Ошибки валидации формы</span>
</span>
</p>
<p>Ввод корректного e-mail'a, темы и текста сообщения и отправка формы
приведет к отправке сообщения и отображения страницы <em>Thank You</em> (см. рисунок 7.22).</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/forms/thank_you_page.png">
<img src="../../en/images/forms/thank_you_page.png" alt="Рисунок 7.22. Страница благодарности" /></a>
<span class="image-caption">Рисунок 7.22. Страница благодарности</span>
</span>
</p>
<p>При ошибке отправке вы увидите страницу <em>Error Sending Email</em> (см. рисунок 7.23):</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/forms/send_error_page.png">
<img src="../../en/images/forms/send_error_page.png" alt="Рисунок 7.23. Страница ошибки отправки письма" /></a>
<span class="image-caption">Рисунок 7.23. Страница ошибки отправки письма</span>
</span>
</p>
<blockquote class="notquote tip" data-type="tip"><p> Форму <em>Contact Us</em> можно увидеть в действии в примере <em>Form Demo</em>, который
 идет в комплекте с этой книгой.</p>
</blockquote>        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Cбор_пользовательских_данных_с_помощью_форм.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Cбор пользовательских данных с помощью форм</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Cбор_пользовательских_данных_с_помощью_форм/Стандартные_помощники_видов_форм.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Cбор_пользовательских_данных_с_помощью_форм/Выводы.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright &copy; 2018 by Oleg Krivtsov            </div>
            <div class="footer-menu">
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/terms-and-conditions.html">Terms &amp; Conditions</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/copyright-policy.html">Copyright Policy</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/privacy-policy.html">Privacy Policy</a>
                </div>
                            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>
<script src="../../assets/js/popup.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

