<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free, read-frendly and open-source book on ZF3">
<meta name="keywords" content="zend framework,book,beginner,free">
<meta name="author" content="2018 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Introducción a RBAC &ndash; Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free, read-frendly and open-source book on ZF3            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Home</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/zf3-api-reference/html/">Class Reference</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Role_Based_Access_Control/Obtener_el_ejemplo_de_gestión_de_roles_del_GitHub.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Role_Based_Access_Control/Default_Roles_in_the_Role_Demo_Sample.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Role_Based_Access_Control.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Role-Based Access Control</span>
        </a>
    </div>
    </div>

﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">
<div class="incomplete-translation">
    Translation into this language is not yet finished. You can help this project 
    by translating the chapters and contributing your changes.
</div>

<h2 id="Introducción_a_RBAC">17.2. Introducción a RBAC</h2>
<p>ZF3 provee un componente especial llamado <code>Zend\Permissions\Rbac</code> que implementa
un contenedor para roles y permisos.</p>
<p>Para instalar el componente <code>Zend\Permissions\Rbac</code> en nuestra aplicación web,
escribimos el siguiente comando.</p>
<pre class=""><code class="language-text">php composer.phar require zendframework/zend-permissions-rbac
</code></pre>
<h3 id="Roles_y_permisos">17.2.1. Roles y permisos</h3>
<p>Un <em>rol</em> es un grupo de usuario. Por ejemplo, en una aplicación de Blog pueden
existir los siguientes roles: Espectador, Autor, Editor y Administrador.</p>
<div class="table-wrapper">
<div class="table-caption">Tabls 17.1. Ejemplo de roles para un Blog</div><table>
<thead>
<tr>
<th> <em>Nombre del roles</em>             </th>
<th> <em>Descripción</em>                                                 </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <code>Viewer</code>                       </td>
<td>  Solo puede leer cualquier publicación.                        </td>
</tr>
<tr>
<td> <code>Author</code>                                                        </td>
<td> Puede ver las publicaciones y además crear una publicación,     editarla y publicarla.                                        </td>
</tr>
<tr>
<td> <code>Editor</code>                                                        </td>
<td> Puede ver las publicaciones y además editar y publicar          cualquier publicación.                                        </td>
</tr>
<tr>
<td> <code>Administrator</code>                                                 </td>
<td> Puede hacer todo lo que puede hacer un <em>Viewer</em> y un <em>Editor</em>   y además puede borrar las publicaciones.                      </td>
</tr>
</tbody>
</table>
</div>
<p>Un <em>usuario</em> puede ser asignado a uno o varios roles de una vez. Por ejemplo,
el usuario <em>John</em> puede ser un <em>Viewer</em> y un <em>Editor</em> al mismo tiempo.</p>
<p>Un rol puede <em>heredar</em> permisos de otros roles. En otras palabras, los roles
se pueden organizar en una jerarquía en donde los roles padres heredan permisos
de los roles hijos. Por ejemplo, en un Blog, el rol <em>Administrator</em> podría
heredar permisos del rol <em>Editor</em> (ver figura 17.1 más abajo). Esto es porque
el rol <em>Administrator</em> puede hacer las mismas cosas que el <em>Editor</em> y además
borrar publicaciones. Los roles <em>Editor</em> y <em>Author</em> podrían heredar permisos
del role <em>Viewer</em>.</p>
<p><span class="image-wrapper">
<a target="_blank" href="../../en/images/roles/role_hierarchy_in_a_blog_app.png">
<img src="../../en/images/roles/role_hierarchy_in_a_blog_app.png" alt="Figura 17.1 Jerarquía de roles un un Blog" /></a>
<span class="image-caption">Figura 17.1 Jerarquía de roles un un Blog</span>
</span>
</p>
<p>A un rol se le pueden asignar varios <em>permisos</em>. Un permiso es un sola acción
típica en el sistema. Aquí hay varios ejemplos de permisos en un Blog:</p>
<div class="table-wrapper">
<div class="table-caption">Tabla 17.2. Ejemplo de permisos en un Blog</div><table>
<thead>
<tr>
<th> <em>Nombre del permiso</em>           </th>
<th> <em>Descripción</em>                                                 </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <code>post.view</code>                    </td>
<td>  Ver cualquier publicación.                                    </td>
</tr>
<tr>
<td> <code>post.edit</code>                    </td>
<td> Editar cualquier publicación.                                 </td>
</tr>
<tr>
<td> <code>post.own.edit</code>                </td>
<td> Editar solo las publicaciones de las que se es dueño.         </td>
</tr>
<tr>
<td> <code>post.publish</code>                 </td>
<td> Publicar cualquier publicación.                               </td>
</tr>
<tr>
<td> <code>post.own.publish</code>             </td>
<td> Publicar solo las publicaciones de las que se es dueño.       </td>
</tr>
<tr>
<td> <code>post.delete</code>                  </td>
<td> Borrar cualquier publicación.                                 </td>
</tr>
</tbody>
</table>
</div>
<p>Por ejemplo, al rol <em>Viewer</em> se le puede asignar el permiso <code>post.view</code>. El
rol <em>Editor</em> puede tener los permisos <code>post.edit</code> y <code>post.publish</code>. El role
<em>Author</em> podría tener los permisos <code>post.own.edit</code> y <code>post.own.publish</code>. Y
el rol <em>Administrator</em> tendría asignado el permiso <code>post.delete</code>.</p>
<h3 id="Contenedor_RBAC">17.2.2. Contenedor RBAC</h3>
<p>En ZF3, podemos usar la clase <code>Rbac</code> que vive en el espacio de nombres
<code>Zend\Permissions\Rbac</code> como un contenedor simple para nuestros roles y
permisos. Con este contenedor, guardamos nuestros roles en memoria organizados
en una jerarquía y con permisos asignados.</p>
<p>Por ejemplo, vamos a crear un contenedor <code>Rbac</code> para el Blog y lo llenaremos
con roles y permisos:</p>
<pre class=""><code class="language-php">use Zend\Permissions\Rbac\Rbac;

// Create Rbac container.
$rbac = new Rbac();

// The following is to tell Rbac to create some parent roles if not exist yet
$rbac-&gt;setCreateMissingRoles(true);

// Create role hierarchy
$rbac-&gt;addRole('Viewer', ['Editor', 'Author']);
$rbac-&gt;addRole('Editor', ['Administrator']);
$rbac-&gt;addRole('Author');
$rbac-&gt;addRole('Administrator');

// Assign permissions to the Viewer role.
$rbac-&gt;getRole('Viewer')-&gt;addPermission('post.view');

// Assign permissions to the Author role.
$rbac-&gt;getRole('Author')-&gt;addPermission('post.own.edit');
$rbac-&gt;getRole('Author')-&gt;addPermission('post.own.publish');

// Assign permissions to the Editor role.
$rbac-&gt;getRole('Editor')-&gt;addPermission('post.edit');
$rbac-&gt;getRole('Editor')-&gt;addPermission('post.publish');

// Assign permissions to the Administrator role.
$rbac-&gt;getRole('Administrator')-&gt;addPermission('post.delete');
</code></pre>
<p>Como podemos ver, un role se agrega al contenedor <code>Rbac</code> con la ayuda del
método <code>addRole()</code>. El método <code>addRole()</code> toma dos argumentos: el nombre del
rol que se creará y el nombre o los nombres de su o sus roles padres. Si los
roles padres no existen aún, ellos se crean automáticamente (con este propósito
usamos el método <code>setCreateMissingRoles()</code>).</p>
<p>Los permisos se asignan al role creado con la ayuda del método de role
<code>addPermission()</code>.</p>
<h3 id="Revisar_permisos">17.2.3. Revisar permisos</h3>
<p>Cuando tenemos el contenedor <code>Rbac</code> configurado podemos consultar si el rol
tiene determinado permiso con el método <code>isGranted()</code>, de la siguiente manera:</p>
<pre class=""><code class="language-php">// The following will return false, because the Viewer can't delete posts
$rbac-&gt;isGranted('Viewer', 'post.delete');

// The following will return true, because admins can delete posts
$rbac-&gt;isGranted('Administrator', 'post.delete');
</code></pre>
<p>El método <code>isGranted()</code> revisa el role y su hijos y busca el permiso dado.
Si encuentra el permiso regresa <code>true</code> de lo contrario regresa <code>false</code>.</p>
        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
﻿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Role_Based_Access_Control.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Role-Based Access Control</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Role_Based_Access_Control/Obtener_el_ejemplo_de_gestión_de_roles_del_GitHub.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Role_Based_Access_Control/Default_Roles_in_the_Role_Demo_Sample.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright &copy; 2018 by Oleg Krivtsov            </div>
            <div class="footer-menu">
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/terms-and-conditions.html">Terms &amp; Conditions</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/copyright-policy.html">Copyright Policy</a>
                </div>
                                <div class="footer-link">
                    <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/legal/privacy-policy.html">Privacy Policy</a>
                </div>
                            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>
<script src="../../assets/js/popup.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

